vars: 
  - file: values/{{ args.environment }}.yaml  # Common variables for all deployments

# Ordered list of deployments to process
deployments:
  # Infrastructure components (cert-manager and Traefik) - deployed first
  - path: components/cert-manager
    tags: [infrastructure, cert-manager]
  
  - path: components/traefik
    tags: [infrastructure, traefik]
  
  # First set up the namespace
  - path: components/common
    tags: [common, namespace]
  
  # Database (PostgreSQL)
  - path: components/postgresql
    tags: [db, postgresql]
  
  # Backend application
  - path: components/backend
    tags: [backend]
  
  # Frontend application
  - path: components/frontend
    tags: [frontend]
  
  # Security scanning with Trivy Operator
  - path: components/trivy-operator
    tags: [security, trivy]

commonLabels:
  app: microadventures